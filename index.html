<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ketuk untuk Memulai</title>

  <style>
    :root{ --text:#111; }
    *{ box-sizing:border-box; font-family:system-ui, Arial, sans-serif; }

    body{
      margin:0;
      background:url("assets/img/bgmathreveal.png") center / cover no-repeat;
      color:var(--text);
      overflow:hidden;
    }

    /* Layar full, jangan flex biar konsisten dengan menu */
    .screen{
      position:relative;
      min-height:100vh;
      width:100%;
      cursor:pointer;
      user-select:none;
      text-align:center;
    }

    /* âœ… LOGO: posisi + ukuran dibuat sama persis dengan menu */
    .logo{
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%, -50%);
      width:520px;      /* konsisten */
      max-width:85vw;   /* tetap responsif */
      height:auto;
      display:block;
      pointer-events:none;
      user-select:none;
    }

    /* teks ikut anchor center yang sama, turun dari logo */
    .tapTextWrap{
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%, -50%);
      margin-top:220px; /* jarak dari logo (samakan dengan menu) */
      width:100%;
      padding:0 16px;
      display:flex;
      justify-content:center;
    }

    .tapText{
      font-size:17px;
      opacity:.9;
      letter-spacing:.2px;
      color:#fff;
      animation: blink 1.2s ease-in-out infinite;
      text-shadow: 0 2px 8px rgba(0,0,0,.6);
    }

    @keyframes blink{
      0%,100%{ opacity:1; }
      50%{ opacity:.25; }
    }
  </style>
</head>
<body>

  <main class="screen" id="tapArea" aria-label="Tap to start">
    <img
      src="assets/img/logomathreveal.png"
      alt="Math Reveal"
      class="logo"
      draggable="false"
    />

    <div class="tapTextWrap">
      <div class="tapText">Ketuk layar di mana saja untuk memulai</div>
    </div>
  </main>

  <audio id="bgm" loop preload="auto">
    <source src="assets/audio/mathreveal.mp3" type="audio/mpeg">
  </audio>

  <script>
    const tapArea = document.getElementById("tapArea");
    const bgm = document.getElementById("bgm");
    let started = false;

    function persistTime(){
      try{ sessionStorage.setItem("bgmTime", String(bgm.currentTime || 0)); }catch(_){}
    }

    function goMenu(){
      persistTime();
      window.location.href = "menu.html";
    }

    async function startGame(){
      if (started) return;
      started = true;

      // flag supaya halaman lain auto-play
      localStorage.setItem("bgmUnlocked", "1");

      // play musik (harus setelah gesture)
      bgm.volume = 0.4;
      try{ await bgm.play(); }catch(_){}

      // simpan posisi beberapa kali biar aman
      persistTime();
      setTimeout(persistTime, 50);

      // pindah ke menu
      setTimeout(goMenu, 150);
    }

    tapArea.addEventListener("click", startGame, { passive:true });
    tapArea.addEventListener("touchstart", startGame, { passive:true });
    window.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") startGame();
    });

    // kalau tiba-tiba pindah tab / reload
    window.addEventListener("pagehide", persistTime);
  </script>
</body>
</html>
