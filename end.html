<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Game Selesai â€¢ Reveal Quiz</title>
  <style>
    :root{
      --panel:#d9d9d9;
      --stroke:#222;
      --text:#111;
      --muted:rgba(0,0,0,.65);
      --roundBig:28px;
      --round:22px;
    }
    *{box-sizing:border-box;font-family:system-ui,Arial,sans-serif}
    body{margin:0;background:#fff;color:var(--text)}
    .page{max-width:1100px;margin:0 auto;padding:26px}

    .stack{
      min-height:calc(100vh - 52px);
      display:flex;flex-direction:column;
      justify-content:center;align-items:center;
      gap:14px;text-align:center;
    }

    .title{font-weight:900;letter-spacing:.6px;margin:0;font-size:28px}
    .subtitle{margin:0 0 18px;font-weight:700;color:var(--muted);font-size:20px}

    .card{
      background:var(--panel);
      border:2px solid var(--stroke);
      border-radius:var(--roundBig);
      padding:16px 18px;
    }

    .bigStat{width:min(520px, 92vw);padding:18px 18px 14px}
    .bigLabel{font-weight:800;color:var(--muted);margin:0 0 6px}
    .bigValue{font-weight:950;font-size:74px;line-height:1;margin:0}

    .row{
      display:grid;grid-template-columns:1fr 1fr;
      gap:18px;width:min(820px, 92vw);margin-top:10px;
    }
    @media (max-width: 760px){ .row{grid-template-columns:1fr} }

    .smallStat{
      padding:16px 18px 12px;min-height:140px;
      display:flex;flex-direction:column;
      justify-content:center;align-items:center;gap:6px;
    }
    .smallLabel{font-weight:800;color:var(--muted);margin:0}
    .smallValue{font-weight:950;font-size:64px;line-height:1;margin:0}

    .actions{
      display:flex;gap:18px;flex-wrap:wrap;
      justify-content:center;margin-top:22px;
    }
    .btn{
      background:var(--panel);
      border:2px solid var(--stroke);
      border-radius:var(--roundBig);
      padding:18px 22px;
      font-weight:900;cursor:pointer;
      min-width:120px;min-height:84px;
      display:flex;align-items:center;justify-content:center;
      user-select:none;
    }
    .btn:hover{filter:brightness(.98)}
  </style>
</head>
<body>
  <main class="page">
    <section class="stack">
      <h1 class="title">GAME SELESAI</h1>
      <p class="subtitle">Kamu sudah menamatkan semua level</p>

      <div class="card bigStat">
        <p class="bigLabel">Total Level</p>
        <p id="totalLevel" class="bigValue">29</p>
      </div>

      <div class="row">
        <div class="card smallStat">
          <p class="smallLabel">Hint dipakai</p>
          <p id="hintUsed" class="smallValue">0</p>
        </div>

        <div class="card smallStat">
          <p class="smallLabel">Total Salah</p>
          <p id="totalWrong" class="smallValue">0</p>
        </div>
      </div>

      <div class="actions">
        <button id="btnExit" class="btn">Keluar</button>
        <button id="btnReplay" class="btn">Main Lagi</button>
      </div>
    </section>
  </main>

  <script>
    const SAVE_KEY = "revealQuizSave";
    const TOTAL_LEVELS = 29;

    function loadSave(){
      try{
        const raw = localStorage.getItem(SAVE_KEY);
        return raw ? JSON.parse(raw) : null;
      }catch(e){
        return null;
      }
    }

    function writeSave(obj){
      obj.updatedAt = Date.now();
      localStorage.setItem(SAVE_KEY, JSON.stringify(obj));
    }

    const save = loadSave() || {};
    const hintUsed = Number.isFinite(save.hintUsed) ? save.hintUsed : 0;
    const wrongTotal = Number.isFinite(save.wrongTotal) ? save.wrongTotal : 0;

    document.getElementById("totalLevel").textContent = String(TOTAL_LEVELS);
    document.getElementById("hintUsed").textContent = String(hintUsed);
    document.getElementById("totalWrong").textContent = String(wrongTotal);

    document.getElementById("btnExit").addEventListener("click", () => {
      window.location.href = "menu.html";
    });

    document.getElementById("btnReplay").addEventListener("click", () => {
      // reset run (tetap simpan file save biar konsisten)
      const next = {
        ...save,
        version: save.version || 1,
        createdAt: save.createdAt || Date.now(),
        updatedAt: Date.now(),

        level: 1,
        phaseIndex: 0,
        tilesOpen: 0,
        tileOrder: [],
        hintsLeft: (typeof save.hintsLeft === "number") ? save.hintsLeft : 3,

        // reset statistik run
        wrongTotal: 0,
        hintUsed: 0,
      };
      writeSave(next);
      window.location.href = "HalLevel.html";
    });
  </script>
</body>
</html>
