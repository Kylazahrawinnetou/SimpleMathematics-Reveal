<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Menu ‚Ä¢ Math Reveal</title>

  <style>
    :root{
      --text:#111;
      --btn:#d6d6d6;
      --btnHover:#cfcfcf;
      --stroke:#222;
    }

    *{
      box-sizing:border-box;
      font-family:system-ui, Arial, sans-serif;
    }

    body{
      margin:0;
      background:#fff;
      color:var(--text);
      overflow:hidden; /* tidak scroll */
    }

    .screen{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:6px;          /* ‚úÖ JARAK PALING RAPAT */
      padding:12px;     /* kecil, aman */
      text-align:center;
    }

    /* LOGO TANPA PEMBUNGKUS */
    .logo{
      width:min(480px, 85vw);
      height:auto;
      display:block;
      pointer-events:none;
      user-select:none;
      margin:0;         /* ‚ùå NO MARGIN */
    }

    .btn{
      width:min(420px, 80vw);
      padding:16px 18px;
      font-size:28px;
      font-weight:800;
      border:2px solid var(--stroke);
      background:var(--btn);
      border-radius:22px;
      cursor:pointer;
      user-select:none;
      margin:0;         /* ‚ùå NO MARGIN */
    }
    .btn:hover{ background:var(--btnHover); }

    .btn.small{
      width:min(360px, 70vw);
      font-size:24px;
      padding:14px 18px;
      border-radius:18px;
    }
  </style>
</head>
<body>

  <main class="screen">
    <img
      src="assets/img/logomathreveal.png"
      alt="Math Reveal"
      class="logo"
      draggable="false"
    />

    <button id="btnStart" class="btn" type="button">Mulai</button>
    <button id="btnReset" class="btn small" type="button">Hapus Data</button>
  </main>

  <!-- üéµ BGM LANJUT -->
  <audio id="bgm" loop preload="auto">
    <source src="assets/audio/mathreveal.mp3" type="audio/mpeg">
  </audio>

  <script>
    /* ===== BGM LANJUT DARI INDEX ===== */
    const bgm = document.getElementById("bgm");

    function resumeBgm(){
      if (localStorage.getItem("bgmUnlocked") !== "1") return;

      const t = Number(sessionStorage.getItem("bgmTime") || "0");
      if (t > 0){
        try{ bgm.currentTime = t; }catch(_){}
      }

      bgm.volume = 0.4;
      bgm.play().catch(()=>{});
    }

    function persistTime(){
      try{
        sessionStorage.setItem("bgmTime", String(bgm.currentTime || 0));
      }catch(_){}
    }

    resumeBgm();
    window.addEventListener("pagehide", persistTime);

    /* ===== SAVE SYSTEM ===== */
    const SAVE_KEY = "revealQuizSave";
    const NEXT_PAGE = "aturan.html";

    function makeNewSave(){
      return {
        version: 1,
        createdAt: Date.now(),
        level: 1,
        hintsLeft: 3,
        wrongTotal: 0,
        hintUsed: 0
      };
    }

    function loadSave(){
      try{
        const raw = localStorage.getItem(SAVE_KEY);
        return raw ? JSON.parse(raw) : null;
      }catch(_){
        return null;
      }
    }

    function save(data){
      localStorage.setItem(SAVE_KEY, JSON.stringify(data));
    }

    document.getElementById("btnStart").addEventListener("click", () => {
      if (!loadSave()) save(makeNewSave());
      persistTime();
      window.location.href = NEXT_PAGE;
    });

    document.getElementById("btnReset").addEventListener("click", () => {
      if (!confirm("Yakin mau hapus semua data game?")) return;
      localStorage.removeItem(SAVE_KEY);
      alert("Data game sudah dihapus.");
    });
  </script>

</body>
</html>
